-- first some tests of basic functionality
--
-- better succeed
--
select writeFile();
        writefile         
--------------------------
 wrote foobar to /tmp/foo
(1 row)

-- make sure the file doesn't exist on the host filesystem
\! ls -l /tmp/foo
ls: cannot access /tmp/foo: No such file or directory
select test_spi_tup('select fname, lname,username from users order by 1,2,3');
    test_spi_tup    
--------------------
 (jane,doe,j_doe)
 (john,doe,johnd)
 (rick,smith,slash)
 (willem,doe,w_doe)
(4 rows)

select test_spi_ta('select oid, typname from pg_type where typname = ''oid'' or typname = ''text''');
     test_spi_ta      
----------------------
 {{25,text},{26,oid}}
(1 row)

select test_mia();
          test_mia          
----------------------------
 {{1,3,5,7,9},{2,4,6,8,10}}
(1 row)

select rlog100();
 rlog100 
---------
 2
(1 row)

select pg_spi_exec('select 1');
 pg_spi_exec 
-------------
 1
(1 row)

select pyint(NULL::int2);
 pyint 
-------
      
(1 row)

select pyint(1::int2);
 pyint 
-------
     1
(1 row)

select pyint(1::int4);
 pyint 
-------
     1
(1 row)

select pyint(1::int8);
 pyint 
-------
     1
(1 row)

select pyfloat(1.2::float4);
 pyfloat 
---------
     1.2
(1 row)

select pyfloat(1.2::float8);
 pyfloat 
---------
     1.2
(1 row)

select pybool('f');
 pybool 
--------
 f
(1 row)

select pybool('t');
 pybool 
--------
 t
(1 row)

select pylog100();
 pylog100 
----------
        2
(1 row)

select pylog(10000, 10);
 pylog 
-------
     4
(1 row)

select concat(fname, lname) from users order by 1;
  concat   
-----------
 janedoe
 johndoe
 ricksmith
 willemdoe
(4 rows)

select concatall();
       concatall       
-----------------------
 jane,john,rick,willem
(1 row)

select nested_call_three('a');
 nested_call_three 
-------------------
 a
(1 row)

select nested_call_two('a');
      nested_call_two       
----------------------------
 {'nested_call_three': 'a'}
(1 row)

select nested_call_one('a');
                  nested_call_one                  
---------------------------------------------------
 {'nested_call_two': "{'nested_call_three': 'a'}"}
(1 row)

select invalid_function();
ERROR:  exception occurred: (plcontainer.c:457)
DETAIL:  'module' object has no attribute 'foobar'
select invalid_syntax();
ERROR:  exception occurred: (plcontainer.c:457)
DETAIL:  ('invalid syntax', ('<string>', 7, 1, '\n'))
select rlog100_shared();
 rlog100_shared 
----------------
 2
(1 row)

select pylog100_shared();
 pylog100_shared 
-----------------
               2
(1 row)

